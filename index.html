<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MHC Forescate Kledingregistratie</title>
<style>
  :root {
    --club-lightblue: #8ec9e6;
    --club-darkblue: #003366;
    --club-white: #ffffff;
    --club-gray: #f5f5f5;
  }
  body { font-family: Arial, sans-serif; margin: 30px; background: var(--club-gray); color: #333; }
  .header { display: flex; align-items: center; margin-bottom: 30px; }
  .header img { height: 60px; margin-right: 20px; }
  .header h1 { margin: 0; color: var(--club-darkblue); }
  h2 { color: var(--club-darkblue); margin-top: 0; }
  .panel { background: var(--club-white); padding: 20px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  input, select { width: 100%; padding: 8px; margin: 10px 0 15px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
  button { padding: 10px 15px; background: var(--club-darkblue); color: var(--club-white); border: none; border-radius: 5px; cursor: pointer; font-size: 1rem; transition: background 0.3s ease; }
  button:hover { background: var(--club-lightblue); color: var(--club-darkblue); }
  table { width: 100%; border-collapse: collapse; background: var(--club-white); }
  table th { background: var(--club-darkblue); color: var(--club-white); padding: 10px; text-align: left; }
  table td { padding: 10px; border: 1px solid #ccc; }
  .error { color: red; margin-top: -10px; margin-bottom: 10px; }
  .delete-btn { background-color: #d9534f; border: none; color: white; padding: 6px 10px; border-radius: 5px; cursor: pointer; font-weight: bold; }
  .delete-btn:hover { background-color: #c9302c; }
  @media (max-width: 600px) { .header { flex-direction: column; align-items: flex-start; } .header img { margin-bottom: 15px; } }
  .tab-buttons { margin-bottom: 15px; }
  .tab-buttons button { margin-right: 10px; }
  .hidden { display: none; }
</style>
</head>
<body>

<div class="header">
  <img src="forescate-logo.png" alt="MHC Forescate logo" />
  <h1>Kledingregistratie – MHC Forescate</h1>
</div>

<div id="login-section" class="panel">
  <h2>Beheerder Login</h2>
  <input id="admin-password" type="password" placeholder="Wachtwoord" />
  <button onclick="loginAdmin()">Login</button>
  <p id="login-error" class="error"></p>
</div>

<div id="app-section" style="display:none;">

  <div class="tab-buttons">
    <button onclick="showTab('registraties')">Registraties</button>
    <button onclick="showTab('voorraadbeheer')">Voorraadbeheer</button>
  </div>

  <!-- Registraties tab -->
  <div id="registraties" class="panel">

    <div style="margin-bottom:20px;">
      <label for="importCsv">Importeer leden & teams (CSV met Naam,Team,Geslacht): </label>
      <input type="file" id="importCsv" accept=".csv" />
      <button onclick="importLeden()">Importeren</button>
      <p id="importStatus" style="color:green;"></p>
    </div>

    <h2>Nieuwe registratie</h2>
    <form id="kledingForm">
      <label for="naam">Speler</label>
      <select id="naam" required>
        <option value="" disabled selected>-- Kies speler --</option>
      </select>
      <button type="button" onclick="nieuwSpelerToevoegen()">Nieuwe speler toevoegen</button>

      <label for="geslacht">Geslacht</label>
      <select id="geslacht" required>
        <option value="" disabled selected>-- Kies geslacht --</option>
        <option value="Man">Man</option>
        <option value="Vrouw">Vrouw</option>
      </select>

      <label for="team">Team</label>
      <select id="team" required>
        <option value="" disabled selected>-- Kies team --</option>
      </select>

      <label for="maat_shirt">Maat shirt</label>
      <select id="maat_shirt" required></select>

      <label for="maat_broek">Maat broek/rok</label>
      <select id="maat_broek" required></select>

      <label for="maat_jack">Maat jack</label>
      <select id="maat_jack" required></select>

      <label for="maat_sokken">Maat sokken</label>
      <select id="maat_sokken" required>
        <option value="28-32">28-32</option>
        <option value="33-36">33-36</option>
        <option value="36-40">36-40</option>
        <option value="40-44">40-44</option>
        <option value="45-47">45-47</option>
      </select>

      <button type="submit">Opslaan</button>
    </form>

    <div class="panel" style="margin-top:20px;">
      <h2>Teamfilter</h2>
      <select id="teamFilter" onchange="updateTable()">
        <option value="">Alle teams</option>
      </select>
    </div>

    <div class="panel" style="margin-top:20px;">
      <h2>Registraties</h2>
      <button onclick="exportCSV()">Exporteren naar CSV</button>
      <table id="registratieTable">
        <thead>
          <tr>
            <th>Naam</th>
            <th>Geslacht</th>
            <th>Team</th>
            <th>Shirt</th>
            <th>Broek/Rok</th>
            <th>Jack</th>
            <th>Sokken</th>
            <th>Verwijderen</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Voorraadbeheer tab -->
  <div id="voorraadbeheer" class="panel hidden">
    <h2>Voorraadbeheer</h2>
    <form id="voorraadForm">
      <div id="voorraadInputs"></div>
      <button type="submit">Voorraad opslaan</button>
    </form>
  </div>

</div>

<script>
const ADMIN_PASSWORD = "Hockey123";
const maten = ["6-8 jaar","8-10 jaar","10-12 jaar","12-14 jaar","XXS","XS","S","M","L","XL","XXL"];
const sokkenMaten = ["28-32","33-36","36-40","40-44","45-47"];
const kledingTypes = ["shirt", "broek", "jack", "sokken"];

// Admin login
function loginAdmin() {
  const pw = document.getElementById("admin-password").value.trim();
  if (pw === ADMIN_PASSWORD) {
    document.getElementById("login-section").style.display = "none";
    document.getElementById("app-section").style.display = "block";
    initApp();
  } else {
    document.getElementById("login-error").innerText = "Onjuist wachtwoord";
  }
}

// Dropdown maten
["maat_shirt","maat_broek","maat_jack"].forEach(id => {
  const select = document.getElementById(id);
  maten.forEach(m => {
    let option = document.createElement("option");
    option.value = option.textContent = m;
    select.appendChild(option);
  });
});

// Registraties & Voorraad
let registraties = JSON.parse(localStorage.getItem("registraties") || "[]");
let voorraad = JSON.parse(localStorage.getItem("voorraad")) || {
  shirt: Object.fromEntries(maten.map(m => [m,5])),
  broek: Object.fromEntries(maten.map(m => [m,5])),
  jack: Object.fromEntries(maten.map(m => [m,5])),
  sokken: Object.fromEntries(sokkenMaten.map(m => [m,10]))
};
let leden = JSON.parse(localStorage.getItem("leden")) || [];

// Save functies
function saveRegistraties(){localStorage.setItem("registraties", JSON.stringify(registraties));}
function saveVoorraad(){localStorage.setItem("voorraad", JSON.stringify(voorraad));}
function saveLeden(){localStorage.setItem("leden", JSON.stringify(leden));}

// Voorraadbeheer inputs
function maakVoorraadInputs() {
  const container = document.getElementById("voorraadInputs");
  container.innerHTML = "";
  kledingTypes.forEach(type => {
    const div = document.createElement("div");
    div.style.marginBottom = "20px";
    const label = document.createElement("h3");
    label.textContent = `Voorraad: ${type.charAt(0).toUpperCase() + type.slice(1)}`;
    div.appendChild(label);
    const matenLijst = (type==="sokken")?sokkenMaten:maten;
    matenLijst.forEach(m => {
      const inputId = `voorraad_${type}_${m.replace(/\s/g,"").replace(/-/g,"_")}`;
      const row = document.createElement("div");
      row.style.display = "flex";
      row.style.alignItems = "center";
      row.style.marginBottom = "5px";
      const maatLabel = document.createElement("label");
      maatLabel.setAttribute("for", inputId);
      maatLabel.textContent = m;
      maatLabel.style.width = "100px";
      const input = document.createElement("input");
      input.type="number"; input.min="0"; input.value=voorraad[type][m]??0; input.id=inputId; input.required=true; input.style.width="80px";
      row.appendChild(maatLabel); row.appendChild(input);
      div.appendChild(row);
    });
    container.appendChild(div);
  });
}

// Registraties tabel
function updateTeamFilter() {
  const teams = [...new Set(registraties.map(r=>r.team))].sort();
  const tf = document.getElementById("teamFilter");
  tf.innerHTML = '<option value="">Alle teams</option>';
  teams.forEach(t => tf.innerHTML+=`<option value="${t}">${t}</option>`);
}
function updateTable() {
  const filterTeam = document.getElementById("teamFilter").value;
  const tbody = document.querySelector("#registratieTable tbody");
  tbody.innerHTML = "";
  registraties.filter(r=>filterTeam===""||r.team===filterTeam)
  .forEach((r,i)=>{
    tbody.innerHTML+=`<tr>
      <td>${r.naam}</td>
      <td>${r.geslacht}</td>
      <td>${r.team}</td>
      <td>${r.shirt}</td>
      <td>${r.broek}</td>
      <td>${r.jack}</td>
      <td>${r.sokken}</td>
      <td><button class="delete-btn" onclick="verwijderReg(${i})">X</button></td>
    </tr>`;
  });
  updateTeamFilter();
}
function verwijderReg(i){registraties.splice(i,1);saveRegistraties();updateTable();}

// Voorraad verlagen na registratie
function verlaagVoorraad(type,maat){if(!voorraad[type]) return; if(voorraad[type][maat]>0){voorraad[type][maat]--;saveVoorraad();}else{alert(`Let op: voorraad van ${type} maat ${maat} is op!`);}}

// Registratie submit
document.getElementById("kledingForm").addEventListener("submit", e=>{
  e.preventDefault();
  const r = {
    naam: document.getElementById("naam").value.trim(),
    geslacht: document.getElementById("geslacht").value,
    team: document.getElementById("team").value.trim(),
    shirt: document.getElementById("maat_shirt").value,
    broek: document.getElementById("maat_broek").value,
    jack: document.getElementById("maat_jack").value,
    sokken: document.getElementById("maat_sokken").value
  };
  registraties.push(r); saveRegistraties();
  verlaagVoorraad("shirt",r.shirt);
  verlaagVoorraad("broek",r.broek);
  verlaagVoorraad("jack",r.jack);
  verlaagVoorraad("sokken",r.sokken);
  e.target.reset(); updateTable();
});

// Export CSV
function exportCSV(){
  let csv="Naam,Geslacht,Team,Shirt,Broek/Rok,Jack,Sokken\n";
  registraties.forEach(r=>{
    csv+=`"${r.naam}","${r.geslacht}","${r.team}","${r.shirt}","${r.broek}","${r.jack}","${r.sokken}"\n`;
  });
  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="kledingregistratie.csv";
  a.click();
}

// Tab wisselen
function showTab(tab){
  document.getElementById("registraties").classList.toggle("hidden",tab!=="registraties");
  document.getElementById("voorraadbeheer").classList.toggle("hidden",tab!=="voorraadbeheer");
}

// Voorraad opslaan
document.getElementById("voorraadForm").addEventListener("submit",e=>{
  e.preventDefault();
  kledingTypes.forEach(type=>{
    const matenLijst=(type==="sokken")?sokkenMaten:maten;
    matenLijst.forEach(m=>{
      const inputId=`voorraad_${type}_${m.replace(/\s/g,"").replace(/-/g,"_")}`;
      const val=parseInt(document.getElementById(inputId).value,10);
      if(!isNaN(val)&&val>=0){voorraad[type][m]=val;}
    });
  });
  saveVoorraad();
  alert("Voorraad opgeslagen!");
});

// Leden importeren
function vulLedenDropdowns(){
  const naamSelect=document.getElementById("naam");
  const teamSelect=document.getElementById("team");
  naamSelect.innerHTML='<option value="" disabled selected>-- Kies speler --</option>';
  teamSelect.innerHTML='<option value="" disabled selected>-- Kies team --</option>';
  const uniekeTeams=[...new Set(leden.map(l=>l.team))].sort();
  uniekeTeams.forEach(t=>{
    const opt=document.createElement("option");
    opt.value=t; opt.textContent=t;
    teamSelect.appendChild(opt);
  });
  leden.forEach(l=>{
    const opt=document.createElement("option");
    opt.value=l.naam; opt.textContent=l.naam;
    naamSelect.appendChild(opt);
  });
}

// CSV import functie
function importLeden(){
  const fileInput=document.getElementById("importCsv");
  const status=document.getElementById("importStatus");
  status.textContent="";
  if(!fileInput.files.length){alert("Kies eerst een CSV bestand"); return;}
  const file=fileInput.files[0];
  const reader=new FileReader();
  reader.onload=function(e){
    const tekst=e.target.result;
    const regels=tekst.trim().split(/\r?\n/);
    if(regels.length<2){alert("CSV bestand lijkt leeg of ongeldig");return;}
    const nieuweLeden=[];
    for(let i=1;i<regels.length;i++){
      const regel=regels[i].split(",");
      if(regel.length>=2){
        const naam=regel[0].trim();
        const team=regel[1].trim();
        const geslacht=(regel[2]?regel[2].trim():"");
        if(naam && team){nieuweLeden.push({naam,team,geslacht});}
      }
    }
    if(nieuweLeden.length===0){alert("Geen geldige leden gevonden in CSV");return;}
    const bestaandNamen=new Set(leden.map(l=>l.naam));
    nieuweLeden.forEach(lid=>{if(!bestaandNamen.has(lid.naam)){leden.push(lid);}});
    saveLeden();
    vulLedenDropdowns();
    status.textContent=`${nieuweLeden.length} leden succesvol geïmporteerd!`;
    fileInput.value="";
  };
  reader.readAsText(file);
}

// Nieuwe speler toevoegen knop
function nieuwSpelerToevoegen() {
  const naam = prompt("Naam van de nieuwe speler:");
  if (!naam) return;

  const geslacht = prompt("Geslacht (Man/Vrouw):");
  if (!geslacht || (geslacht !== "Man" && geslacht !== "Vrouw")) {
    alert("Ongeldig geslacht, gebruik 'Man' of 'Vrouw'");
    return;
  }

  const team = prompt("Team van de speler:");
  if (!team) return;

  if (leden.some(l => l.naam === naam)) {
    alert("Deze speler bestaat al!");
    return;
  }

  leden.push({naam, team, geslacht});
  saveLeden();
  vulLedenDropdowns();
  alert(`Speler ${naam} succesvol toegevoegd!`);
}

// Init app
function initApp(){maakVoorraadInputs();updateTable();vulLedenDropdowns();showTab("registraties");}
</script>

</body>
</html>

